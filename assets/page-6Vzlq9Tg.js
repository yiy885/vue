import{n as c,f as d,p as g,E as t,g as m,c as f,o as v}from"./index-CWIg_B7P.js";import{p as _}from"./page-BlJXRgyc.js";const S={__name:"page",setup(h){const r=m(),i=d(),n=useUserStore(),a=c(i.params.templateId),p=async()=>{var s,o,u;if(loading.value=!0,!a.value){t.error("缺少專案 ID，無法加載網頁"),loading.value=!1,r.push("/projects");return}try{const e=await _.getPageByTemplateId(a.value);pageTitle.value=e.data.title,modules.value=e.data.modules.map(l=>({...l,id:l._id||Date.now().toString()+Math.random().toString(36).substring(2,9),content:mapContentArrayToObject(l.content)})),errors.value=[]}catch(e){t.error("加載網頁失敗: "+(((u=(o=(s=e.response)==null?void 0:s.data)==null?void 0:o.error)==null?void 0:u.message)||e.message)),pageTitle.value="未命名網頁",modules.value=[]}finally{loading.value=!1}};return g(()=>{n.id&&a.value?p():n.id?a.value||(t.error("缺少專案 ID，無法加載網頁"),r.push("/projects"),loading.value=!1):(t.info("請先登錄以編輯網頁"),r.push("/login"),loading.value=!1)}),(s,o)=>(v(),f("div"))}};export{S as default};
