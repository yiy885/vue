import{n as d,f as g,p as c,E as t,g as f}from"./index-Blk4pwDk.js";import{p as m}from"./page-DLBQmZFu.js";const y={__name:"page",setup(v){const s=f(),i=g(),o=useUserStore(),a=d(i.params.templateId),p=async()=>{var l,n,u;if(loading.value=!0,!a.value){t.error("缺少專案 ID，無法加載網頁"),loading.value=!1,s.push("/projects");return}try{const e=await m.getPageByTemplateId(a.value);pageTitle.value=e.data.title,modules.value=e.data.modules.map(r=>({...r,id:r._id||Date.now().toString()+Math.random().toString(36).substring(2,9),content:mapContentArrayToObject(r.content)})),errors.value=[]}catch(e){t.error("加載網頁失敗: "+(((u=(n=(l=e.response)==null?void 0:l.data)==null?void 0:n.error)==null?void 0:u.message)||e.message)),pageTitle.value="未命名網頁",modules.value=[]}finally{loading.value=!1}};return c(()=>{o.id&&a.value?p():o.id?a.value||(t.error("缺少專案 ID，無法加載網頁"),s.push("/projects"),loading.value=!1):(t.info("請先登錄以編輯網頁"),s.push("/login"),loading.value=!1)}),()=>{}}};export{y as default};
