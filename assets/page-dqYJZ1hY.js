import{n as c,f as d,p as g,E as s,g as m,c as f,j as v,t as _,o as h}from"./index-DaQMf6hR.js";import{p as y}from"./page-BtKESimt.js";const j={__name:"page",setup(S){const r=m(),i=d(),n=useUserStore(),a=c(i.params.templateId),p=async()=>{var t,o,u;if(loading.value=!0,!a.value){s.error("缺少專案 ID，無法加載網頁"),loading.value=!1,r.push("/projects");return}try{const e=await y.getPageByTemplateId(a.value);pageTitle.value=e.data.title,modules.value=e.data.modules.map(l=>({...l,id:l._id||Date.now().toString()+Math.random().toString(36).substring(2,9),content:mapContentArrayToObject(l.content)})),errors.value=[]}catch(e){s.error("加載網頁失敗: "+(((u=(o=(t=e.response)==null?void 0:t.data)==null?void 0:o.error)==null?void 0:u.message)||e.message)),pageTitle.value="未命名網頁",modules.value=[]}finally{loading.value=!1}};return g(()=>{n.id&&a.value?p():n.id?a.value||(s.error("缺少專案 ID，無法加載網頁"),r.push("/projects"),loading.value=!1):(s.info("請先登錄以編輯網頁"),r.push("/login"),loading.value=!1)}),(t,o)=>(h(),f("div",null,[v("h1",null,_(t.pageTitle),1)]))}};export{j as default};
