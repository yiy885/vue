import{_ as V,u as q,n as d,p as E,i as M,w as l,E as m,g as S,r as s,o as p,a as t,c as C,F,d as I,b as P,K as U,j as z}from"./index-C6sdhQla.js";import{p as N,d as j}from"./page-DLB72yDV.js";import{b as f}from"./route-block-B_A1xBdJ.js";const _={__name:"text-page-1",setup(D){const v=S(),i=q(),g=[{type:"text",name:"文字模塊",content:[{field:"text",value:"",rules:["required","max:200"]},{field:"fontSize",value:16,rules:["min:12","max:48"]},{field:"color",value:"#000000",rules:["color"]},{field:"align",value:"left",rules:["enum:left,center,right"]}]},{type:"image",name:"圖片模塊",content:[{field:"url",value:"",rules:["required","url"]},{field:"alt",value:"",rules:[]},{field:"width",value:300,rules:["min:100"]},{field:"height",value:200,rules:["min:100"]}]},{type:"video",name:"影片模塊",content:[{field:"url",value:"",rules:["required","url"]},{field:"autoplay",value:!1,rules:[]},{field:"thumbnail",value:"",rules:["url"]}]},{type:"custom",name:"自訂模塊",content:[{field:"customField",value:"",rules:["required"]}]}],n=d([]),h=d(!0),y=d([]),x=r=>y.value.some(e=>e.moduleIndex===r);return E(async()=>{var r,e;try{if(!i.id){m.error("請先登錄"),v.push("/login");return}const{data:a}=await N.getByUserId(i.id);a.data&&(pageTitle.value=a.data.title||"我的個人網頁",n.value=a.data.modules.map((o,u)=>({...o,id:o._id||Date.now()+Math.random(),order:o.order??u})))}catch(a){m.error(((e=(r=a.response)==null?void 0:r.data)==null?void 0:e.error)||"無法載入網頁數據")}finally{h.value=!1}}),(r,e)=>{const a=s("el-card"),o=s("el-menu-item"),u=s("el-menu"),b=s("el-aside"),w=s("el-container");return p(),M(w,{style:{height:"100vh"}},{default:l(()=>[t(b,{width:"240px",style:{background:"#f4f4f4",padding:"16px"}},{default:l(()=>[t(a,{shadow:"always"},{header:l(()=>e[1]||(e[1]=[z("h3",null,"模塊工具",-1)])),default:l(()=>[t(u,null,{default:l(()=>[(p(),C(F,null,I(g,k=>t(o,{key:k.type,class:"module-item"},{default:l(()=>[t(P(j),{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=c=>n.value=c),group:"modules","item-key":"id",class:"canvas",style:{"min-height":"500px",border:"1px dashed #ccc",padding:"16px"}},{item:l(({element:c,index:B})=>[t(a,{class:U(["module-card",{error:x(B)}]),shadow:"hover"},null,8,["class"])]),_:2},1032,["modelValue"])]),_:2},1024)),64))]),_:1})]),_:1})]),_:1})]),_:1})}}};typeof f=="function"&&f(_);const A=V(_,[["__scopeId","data-v-ee1b95a0"]]);export{A as default};
